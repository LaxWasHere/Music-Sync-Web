<head>
   <title>SpotifyNet</title>
   <script type="text/javascript" src="js/jquery.min.js"></script>
   <link rel="stylesheet" href="style.css">
   <script type="text/javascript" src="js/lastfm.js"></script>
</head>
<body>
   <center>
      <h2>SpotifyNet by ssamjh</h2>
      <br>
      <audio id="stream-audio" preload="none"></audio>
      <br>
      <button onclick="set_stream_quality('//icecast.sjh.at/spotifynet-hq');">High - 256Kb/s AAC</button>
      <br>
      <button onclick="set_stream_quality('//icecast.sjh.at/spotifynet');">Normal - 128Kb/s AAC</button>
      <br>
      <button onclick="set_stream_quality('//icecast.sjh.at/spotifynet-lq');">Low - 48Kb/s HE-AAC</button>
      <br>
      <br>
      <button id="stop" onclick="stop_button();">Stop</button>
      <br>
      <div id="volume-control">
         <br>
         <a><b>Volume: </b></a>
         <label class="vol-percentage" for="vol-percentage">10</label><a>%</a>
         <br>
         <input id="vol-control" type="range" min="0" max="100" step="0.1" value="10" oninput="set_volume(this.value)" onchange="set_volume(this.value)"></input>
      </div>
      <!-- Code from: https://prashant.me/development/2018/03/04/creating-a-web-widget-to-get-currently-playing-song-tracks-using-lastfm.html -->
      <div class="nowplayingcard">
         <div class="nowplayingcontainer-inner">
            <img id="trackart" src="#">
            <div class="trackInfo">
               <a id="tracktitle"></a>
               <a href="#" id="trackartist"></a>
            </div>
         </div>
      </div>
   </center>
   <script type="text/javascript">
      if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
          window.onload = function() {
              document.getElementById('stream-audio').volume = 1.0;
              console.log('Setting default volume to: 10%');
              document.getElementById('stop').style.visibility = 'hidden';
              console.log('Hiding stop button');
      var elem = document.getElementById("volume-control");
      elem.remove();
      console.log('Hiding volume controls');
          }
      } else {
          window.onload = function() {
              document.getElementById('stream-audio').volume = 0.1;
              console.log('Setting default volume to: 20%');
              document.getElementById('stop').style.visibility = 'hidden';
              console.log('Hiding stop button');
          }
      }
   </script>
   <script type="text/javascript">
      function set_stream_quality(source) {
          document.getElementById("stream-audio").pause();
          console.log('Paused player');
          document.getElementById("stream-audio").setAttribute('src', source);
          console.log('Set source to: ' + source);
          document.getElementById("stream-audio").load();
          console.log('Loading source');
          document.getElementById("stream-audio").play();
          console.log('Playing audio');
          document.getElementById('stop').style.visibility = 'visible';
          console.log('Showing stop button');
      }
   </script>
   <script type="text/javascript">
      function stop_button() {
          document.getElementById('stream-audio').pause();
          console.log('Stopping audio');
          document.getElementById('stop').style.visibility = 'hidden';
          console.log('Hiding stop button');
      }
   </script>
   <script type="text/javascript">
      document.querySelector("#vol-control").addEventListener("input", function(e) {
          document.querySelector(".vol-percentage").textContent = e.currentTarget.value;
          console.log('Volume changed: ' + e.currentTarget.value + '%');
      })
   </script>
   <script type="text/javascript">
      function set_volume(val) {
          var player = document.getElementById('stream-audio');
          player.volume = val / 100;
      }
   </script>
</body>